'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = spawnTSH;

var _child_process = require('child_process');

var _duplexer = require('duplexer');

var _duplexer2 = _interopRequireDefault(_duplexer);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var TSH_BIN = 'tsh';

/**
 * Use the TSH binary to connect to a TSH server.
 *
 * @param {string} host - Host to connect to.
 * @param {number} port - Port to connect to.
 * @return {Promise<Duplex>} - TSH {@link Duplex} stream.
 */
function spawnTSH(host, port) {
  var child = (0, _child_process.spawn)(TSH_BIN, ['--port', port]);
  var stream = (0, _duplexer2.default)(child.stdin, child.stdout);
  stream.close = function () {
    return child.kill();
  };
  return stream;
}